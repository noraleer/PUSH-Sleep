---
title: "push merge and corr"
format: html
editor: visual
---

descriptive stats on both data tests pivot longer on wide and merge them

```{r message = FALSE, warning=FALSE}
library(corrplot)
library(tidyverse)
push_wide <- read_csv("./data/PUSH_actigraph_geo_wide_8.7.25.csv")
push_long <- read_csv("./data/PUSH_long_geo.csv")
```

## Wide Descriptive Stats

```{r}
# amount of actigraph days that are completed
unique(push_wide$C1_ACTI_SL_Interval)

parts <- push_wide %>% select(ParticipantID, C1_ACTI_SL_Interval) 
parts
```

## Long Descriptive Stats

```{r}
# amount of antiactical days that are completed
table(push_long$C_ACTI_Interval)

table(push_long$C_ACTI_Yes) #only 1s, so all actigraph are completed

push_long$C_DD_Yes # 0 and 1; 0 is no daily diary

table(push_long$ParticipantID)
```

### left join

```{r}
# Perform a left join
all <- left_join(push_long, push_wide, by = "ParticipantID")

#Output all 
#write.csv()
```

## Correlation Matrix

**DVs (sleep variables with models run for each sleep DV):**

Sleep Variables \[weekly level\]-

1.  Duration (C_ACTI_SleepTimeAvg)

2.  Timing

-   offset/waketime (C_ACTI_WTmean)

-   onset/falling asleep (C_ACTI_SleepOnsetTime_mean)

3.  Quality

-   efficiency (C_ACTI_EfficiencyAvg)

-   awakenings (C_ACTI_WasoAvg)

4.  Variability

-   Duration (C_ACTI_SleepTime_sd)

-   Timing

-   offset/waketime (C_ACTI_WTsd)

-   onset/falling asleep (C_ACTI_SleepOnsetTime_sd)

**Covariates:**

1.  Sex (c_demo_8_v2)

2.  Age (c_demo_2_v2)

3.  Grade in School (c_demo_6_v2)

4.  Caregiver Highest Education (parent 1: p_demo_26_v2; parent 2: p_demo_27_v2)

5.  School Year/Summer (C_DD_PM_DayType)

-   Note that this is only for Daily Diary

-   Needs to be calculated for Actigraphy (Use Date: C_ACTI_Date)

**Fixed Effects:**

Neighborhood Factors

1.  COI Total (geo_COI_3.0)

2.  COI Domains (3)

-   Education (geo_COI_ED_3.0)

-   Health & Environment (geo_COI_HE_3.0)

-   Social & Economic (geo_COI_SE_3.0)

Family Factors

1.  Family Cohesion Subscale \[higher = more cohesion\]

-   Parent report (P_COHESION)

-   Child report (C_COHESION; individual items are named frm)

2.  MESA

-   MESA Family Trouble Subscale \[score is event count; higher=more family trouble events\] (C_MESA_FT)

-   MESA Economic Stress Subscale \[score is event count; higher=more econ stress events\] (C_MESA_ES)

3.  Adol CHAOS Subscale \[higher=more chaos\] (C_CHAOS)

Sleep Environment Inventory

1.  SEI Sleep Aids Subscale \[interpret so that higher score reflects more sleep aids\] (C_SEI_SA)

2.  SEI Sleep Disturbances Subscale \[interpret so that higher score means less disturbance\] (C_SEI_SD)

3.  SEI Comfort Subscale \[interpret so that higher score means more comfortable environment\] (C_SEI_C)

```{r}
vars <- all %>% select(C1_ACTI_SL_SleepTimeAvg)


all %>%
  select(
    SleepTimeAvg = C1_ACTI_SL_SleepTimeAvg,
    WTmean = C1_ACTI_WTmean,
    SOT_mean = C1_ACTI_SleepOnsetTime_mean,
    EfficiencyAvg = C1_ACTI_SL_EfficiencyAvg,
    WasoAvg = C1_ACTI_SL_WasoAvg,
    WakeTimeSd = C1_ACTI_SL_WakeTimeSd,
    SleepTimeSd = C1_ACTI_SL_SleepTimeSd,
    age = c_demo_2_v2,
    sex = c_demo_8_v2,
    grade_in_school = c_demo_6_v2,
    cg_highest_ed1 = p_demo_26_v2,
    cg_highest_ed2 = p_demo_27_v2,
    school_summer = C_DD_PM_DayType,
    COItotal = geo_COI_3.0, 
    COI_ED = geo_COI_ED_3.0,
    COI_HE = geo_COI_HE_3.0,
    COI_SE = geo_COI_SE_3.0,
    P_COHESION, 
    C_COHESION,
    C_MESA_FT,
    C_MESA_ES,
    C_CHAOS,
    C_SEI_SA,
    C_SEI_SD,
    C_SEI_C
  ) %>% cor(use = "pairwise.complete.obs") %>% corrplot(method = "square", tl.cex = 0.5, addCoef.col = "black", number.cex = 0.3) %>% corrRect(name = c("SleepTimeAvg","age","COItotal","C_SEI_C"))


#C1_ACTI_SL_WTmean)

#, C_ACTI_SleepOnsetTime_mean, C_ACTI_EfficiencyAvg, C_ACTI_WasoAvg, C_ACTI_SleepTime_sd, C_ACTI_WTsd, C_ACTI_SleepOnsetTime_sd)

```