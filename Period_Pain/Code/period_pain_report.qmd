---
title: "Period Pain and Sleep"
authors: 'Josie Peterburs, Oliver Schramm, Gregory J. Matthews'
format: html
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

# Period Pain and Sleep Report

For this project, we want to study how being on your period affects sleep, specifically how period pain and flow affect sleep. We are interested in 6 sleep variables: duration, offset, onset, efficiency, awakenings, and the self-reported quality of sleep.

We have longitudinal data for two different time points for a number of individuals. The first time point is around menarche, and the second time point is about a year later. At each time point, there are about 8 days of data for each individual.

To get the final dataset, we combined 3 datasets:

-   Empathy - personal and environmental variables

-   Actigraphy 1 and 2 - sleep variables

-   Daily Diary 1 and 2 - period variables (whether they are on their period)

```{r, include=FALSE}
library(tidyverse)
library(here)
library(lme4)
library(patchwork)
library(car)
library(lmerTest)

Empathy <- read_csv(here("./Period_Pain/Data", "Empathy_Data_Updated.csv"))

actigraphy_t1 <- readxl::read_xlsx(here("./Period_Pain/Data", "Esleep_T1_Sleep Data_DailyActi_4.22.25.xlsx"))

actigraphy_t2 <- readxl::read_xlsx(here("./Period_Pain/Data", "Esleep_T2_Sleep Data_DailyActi_4.22.25.xlsx"))

diary_t1 <- readxl::read_xlsx(here("./Period_Pain/Data", "E-Sleep_DailyDiary_FINAL_T1Data_updated1.10.26.xlsx"))

diary_t2 <- readxl::read_xlsx(here("./Period_Pain/Data", "E-Sleep_DailyDiary_FINAL_T2Data_updated1.10.26.xlsx"))
```

```{r, include = FALSE}
# remove T2 races from Empathy data bc some entries are missing
Empathy <- Empathy %>% select(-c(demo_child_race___1t2:demo_child_race___5t2))

## Mutating subject_id_t- to a double
actigraphy_t1_dec <- actigraphy_t1 %>% 
  select(-start_time_t1, -end_time_t1) %>% 
  mutate(subject_id_t1 = as.double(subject_id_t1))

actigraphy_t1_dec <- actigraphy_t1_dec %>% 
  mutate(subject_id_t1 = case_when(
    # Subject 524 became NA after changing it to a double
    is.na(subject_id_t1) ~ 524,
    TRUE ~ subject_id_t1
  ))

actigraphy_t2_dec <- actigraphy_t2 %>% 
  select(-start_time_t2, -end_time_t2) %>% 
  mutate(subject_id_t2 = as.double(subject_id_t2))

## Saving T-_DD_NightDate as DateTime variables to create variable 'weekend' later on
diary_t1$T1_DD_NightDate = as.Date(diary_t1$T1_DD_NightDate, origin = "1899-12-30")
diary_t2$T2_DD_NightDate = as.Date(diary_t2$T2_DD_NightDate, origin = "1899-12-30")

## Joining the diary data and actigraphy data for each time point
t1_joined <- diary_t1 %>% 
  full_join(actigraphy_t1_dec, by = c("C_ID" = "subject_id_t1", "T1_DD_DD_Interval" = "interval_number_t1"))

t2_joined <- diary_t2 %>% 
  full_join(actigraphy_t2_dec, by = c("C_ID" = "subject_id_t2", "T2_DD__DD_Interval" = "interval_number_t2"))

## Fixing the names
names(t1_joined) <- gsub("T1", "T", names(t1_joined))
names(t1_joined) <- gsub("t1", "T", names(t1_joined))

names(t2_joined) <- gsub("T2", "T", names(t2_joined))
names(t2_joined) <- gsub("t2", "T", names(t2_joined))

setdiff(names(t1_joined), names(t2_joined))
setdiff(names(t2_joined), names(t1_joined))

t2 <- t2_joined %>%
  rename(T_DD_DD_Interval = T_DD__DD_Interval,
         T_DD_NapDuration = "T_DD_-NapDuration",
         T_DD_CaffType_Juice = T_DD_CaffType_Juices,
         T_DD_MedType3_SSRIs = T_DD_Medtype3_SSRIs,
         onset_latency_T = onset_latency_T...9,
         sleep_midpoint_T = "sleep midpoint_T") %>% 
  select(-onset_latency_T...10)

t1 <- t1_joined %>% 
  rename(T_DD_CaffAmt_LessThanTheRecommendedAmt = T_DD_CaffAmt_LessThanTheRecommendedAmount,
         T_DD_CaffAmt_TheRecommendedAmt = T_DD_CaffAmt_TheRecommendedAmount,
         T_DD_CaffAmt_GreaterThanTheRecommendedAmt = T_DD_CaffAmt_GreaterThanTheRecommendedAmount)

setdiff(names(t2), names(t1))
setdiff(names(t1), names(t2))

## Summary tables for the number of days each subject was in each timepoint
t1 %>% 
  filter(T_DD_Period == 1) %>% 
  select(C_ID, T_DD_Period, T_DD_PeriodPain, T_DD_PeriodDay) %>%
  group_by(C_ID) %>% 
  summarise(num_days = n_distinct(T_DD_PeriodDay)) # %>% 
  # view()
 
t2 %>% 
  filter(T_DD_Period == 1) %>% 
  select(C_ID, T_DD_Period, T_DD_PeriodPain, T_DD_PeriodDay) %>%
  group_by(C_ID) %>% 
  summarise(num_days = n_distinct(T_DD_PeriodDay)) # %>% 
  # view()

## Replacing 999 with NAs in t1 and t2
t1[t1==-999] = NA
t1[t1==-99] = NA
t2[t2==-999] = NA
t2[t2==-99] = NA

#glimpse(t1)
#glimpse(t2)

#Update DayType to 1 is friday-saturday and 0 is any other night
t1 <- t1 %>% mutate(weekend = ifelse((wday(T_DD_NightDate, label = TRUE)) %in% c("Fri","Sat"),1,0))
t2 <- t2 %>% mutate(weekend = ifelse((wday(T_DD_NightDate, label = TRUE)) %in% c("Fri","Sat"),1,0))

## Creating a variable for checking for painkiller (ibuprofen, tylenol)
## Checking MedTypes
table(t1$T_DD_MedType1)
table(t1$T_DD_MedType2)
table(t1$T_DD_MedType3)
table(t1$T_DD_MedType4)
table(t1$T_DD_MedType5)

table(t2$T_DD_MedType1)
table(t2$T_DD_MedType2)
table(t2$T_DD_MedType3)
table(t2$T_DD_MedType4)
table(t2$T_DD_MedType5)
table(t2$T_DD_MedType6)

#Add painkiller indicator
t1 <- t1 %>% mutate(painkiller = ifelse(T_DD_MedType1 %in% c("advil","ibuprofen","Ibuprofen","Ibuprofin"),1,0))
t2 <- t2 %>% mutate(painkiller = ifelse(T_DD_MedType1 %in% c("advil","Advil","ibuprofen","Ibuprofen","Ibuprofin","tylenol") |
                                        T_DD_MedType2 %in% c("advil","Advil","ibuprofen","Ibuprofen","Ibuprofin","tylenol") |
                                        T_DD_MedType6 %in% c("advil","Advil","ibuprofen","Ibuprofen","Ibuprofin","tylenol"),1,0))

#Add time variable
t1 <- t1 %>% mutate(Time = 0, 
                    T_DD_NapOnset = as.numeric(T_DD_NapOnset),
                    T_DD_NapDuration = as.numeric(T_DD_NapDuration),
                    T_DD_ActiDur = as.numeric(T_DD_ActiDur),
                    T_DD_SleepyAlert = as.numeric(T_DD_SleepyAlert),
                    T_DD_MorningDate = as.numeric(T_DD_MorningDate))

t2 <- t2 %>% mutate(Time = 1, 
                    T_DD_NapOnset = as.numeric(T_DD_NapOnset),
                    T_DD_NapDuration = as.numeric(T_DD_NapDuration),
                    T_DD_SleepyAlert = as.numeric(T_DD_SleepyAlert),
                    T_DD_MorningDate = as.numeric(T_DD_MorningDate))

t1 <- t1 %>% select(-c(T_DD_MedType1:T_DD_MedTime5))
t2 <- t2 %>% select(-c(T_DD_MedType1:T_DD_MedTime6))

t1 <- t1 %>% left_join(Empathy %>% select(C_ID, demo_child_age_check_t1:weight3t1, BodyTotalt1), by = "C_ID")
names(t1)[grepl("t1",names(t1))] <- gsub("_t1","",names(t1)[grepl("t1",names(t1))])
names(t1)[grepl("t1",names(t1))] <- gsub("t1","",names(t1)[grepl("t1",names(t1))])

t2 <- t2 %>% left_join(Empathy %>% select(C_ID, demo_child_age_check_t2:weightdifft2, BodyTotalt2), by = "C_ID")
names(t2)[grepl("t2",names(t2))] <- gsub("_t2","",names(t2)[grepl("t2",names(t2))])
names(t2)[grepl("t2",names(t2))] <- gsub("t2","",names(t2)[grepl("t2",names(t2))])
names(t2)[names(t2) == "weigh"] <- "weight2"

# Have to remove weight3 from t1, completely full of NAs after the above operations
t1 <- t1 %>% select(-weight3)

# BodyTotal was stored as a character in t2, as was BMI
t2$BMI <- as.numeric(t2$BMI)
t2$BodyTotal <- as.numeric(t2$BodyTotal)
sleepfull <- bind_rows(t1, t2)

# sleepfull <- sleepfull %>% left_join(Empathy %>% select(C_ID,BodyTotalt0) %>% mutate(BodyTotalt0 = as.numeric(BodyTotalt0)), by = "C_ID")

# rename age and change age and BMI to numeric
sleepfull <- sleepfull %>% mutate(demo_child_age_check = as.numeric(demo_child_age_check)) %>% rename(age = demo_child_age_check)
sleepfull <- sleepfull %>% mutate(BMI = as.numeric(BMI)) 

sleepfull %>% filter(C_ID == 442) %>% select(C_ID, Time, T_DD_NightDate,T_DD_Period, T_DD_PeriodFlow, T_DD_PeriodPain) # %>% View()
table(sleepfull$demo_degree)
table(sleepfull$T_DD_PeriodPain,sleepfull$T_DD_Period)
table(sleepfull$T_DD_PeriodPain)
table(sleepfull$T_DD_PeriodFlow)

# Removing 494 and 522, both of whom had absurd onset/offset times
sleepfull <- sleepfull %>% filter(C_ID != 494 & C_ID != 522)
```

# EDA

```{r}
# distinct participants
n_distinct(sleepfull$C_ID)

# race distribution

# 1 - Asian
# 2 - American Indian or Alaskan Native
# 3 - Black or African American
# 4 - Native Hawaiian or Other Pacific Islander
# 5 - White or Caucasian 

races <- sleepfull %>% 
  select(C_ID, demo_child_race___1:demo_child_race___5) %>% 
  unique() %>% 
  na.omit()

two_plus_races <- races %>%
  rowwise() %>% 
  filter(sum(c_across(demo_child_race___1:demo_child_race___5)) >= 2) %>%
  ungroup() 

l <- two_plus_races %>% select(C_ID) %>% unlist()
not_multiracial <- races %>% filter(!(C_ID %in% l))

# % white: 
not_multiracial %>% filter(demo_child_race___5 == 1) %>% nrow()
# 42 / 63 = 66.7%

# % black: 
not_multiracial %>% filter(demo_child_race___3 == 1) %>% nrow()
# 2 / 63 = 3.2%


# Age distribution in the full dataset
mean(sleepfull$age)
sleepfull %>% group_by(Time) %>% summarize(mean_age = mean(age))
sleepfull %>% group_by(Time) %>% summarize(sd_age = sd(age))
  
# Average age overall is 13.55. At time 1, the average age is 13.3 and at time 2 it is 14.

sleepfull %>% 
  ggplot(aes(x = age)) + 
  geom_histogram() + 
  labs(title = 'Histogram of Age in Full Dataset')

# average age at each time point
sleepfull %>% 
  ggplot(aes(x = age)) + 
  geom_histogram() + 
  facet_grid(~ Time) +
  labs(title = 'Histogram of Age by Time Point')

sleepfull %>% 
  ggplot(aes(y = age)) + 
  geom_boxplot() +
  facet_grid(~ Time) +
  labs(title = 'Boxplot of Age by Time Point')

# difference in age between the time periods
ggplot(sleepfull, aes(x = age, y = as.factor(C_ID))) +
  geom_line() +
  geom_point(aes(color = as.factor(Time)), size = 2) +
  labs(title = 'Difference in Age between Time Points',
       y = 'Subject ID',
       color = 'Time')


## How many unique people are there at each time point.
sleepfull %>%
  group_by(Time) %>% 
  summarise(dist = n_distinct(C_ID))

# There are 65 unique participants at timepoint 1 and 30 unique participants at timepoint 2

# How much sleep are people getting at each time point?
sleepfull %>% summarize(avg_sleep = round(mean(sleep_time_T, na.rm = T), 2), sd_sleep = sd(sleep_time_T, na.rm = T), n = n())

## How many days is someone on their period. 

table(sleepfull$T_DD_Period, useNA = 'always')
96/(529+96)

# Of the 666 total observations across both time points, there are 96 days where a participant was on their period, and 529 days where a participant was not on their period. This comes out to ~15.4% of the observations.

table(sleepfull$T_DD_Period, sleepfull$Time)

## How many days on period at time 1 and time 2.  
sleepfull %>% group_by(Time, T_DD_Period) %>% summarize(n = n())
# As seen here, there are 41 observations where Period is NA. I'm going to look at these observations to see what the other period-related variables are.
sleepfull %>% filter(is.na(T_DD_Period)) %>% select(T_DD_Period:T_DD_PeriodFlow) # %>% view()
# One observation with T_DD_Period = NA has T_DD_PeriodPain and T_DD_PeriodFlow as 0, so this value should be 0 as well. The rest are NA across the board. What should we do with these? ANSWER: KEEP

## Finding the average pain and flow for those on their period at each time point and across both t1 and t2
sleepfull %>% group_by(T_DD_Period) %>% summarize(avg_pain = mean(T_DD_PeriodPain, na.rm = T), sd_pain = sd(T_DD_PeriodPain, na.rm = T), avg_flow = mean(T_DD_PeriodFlow, na.rm = T), sd_flow = sd(T_DD_PeriodFlow, na.rm = T), n = n())
# The average pain level experienced across both time points is 2.82.
# The average flow level experienced across both time points is 4.89.
sleepfull %>% group_by(Time, T_DD_Period) %>% summarize(avg_pain = mean(T_DD_PeriodPain, na.rm = T), sd_pain = sd(T_DD_PeriodPain, na.rm = T), avg_flow = mean(T_DD_PeriodFlow, na.rm = T), sd_flow = sd(T_DD_PeriodFlow, na.rm = T), n = n())
# The average pain level experienced across t1 is 3.27, and the average pain level experienced across t2 is 2.44
# The average flow level experienced across t1 is 5.69, and the average flow level experienced across t2 is 4.25

# Looking to find any NA observations for Pain and Flow
sleepfull %>% filter(T_DD_Period == 0 & Time == 0 ) %>% select(C_ID, T_DD_Period,T_DD_PeriodDay, T_DD_PeriodPain, T_DD_PeriodFlow) # %>% View()
sleepfull %>% filter(T_DD_Period == 0 & Time == 1 ) %>% select(C_ID, T_DD_Period,T_DD_PeriodDay, T_DD_PeriodPain, T_DD_PeriodFlow) # %>% View()

## Painkiller 
# How many observed painkiller uses are there for each trial?
sleepfull %>% group_by(Time) %>% summarise(mn = mean(painkiller), n = n(), sum(painkiller))
sleepfull %>% group_by(Time, T_DD_Period) %>% summarise(n = n(), pk = sum(painkiller))
# There are 14 observed painkiller uses at time point 1, and 6 observed painkiller uses at time point 2
# At both time points, 4 of the painkiller users were on their period. 
sleepfull %>% group_by(painkiller) %>% 
  summarise(avg_pain = mean(T_DD_PeriodPain, na.rm = T), 
            avg_flow = mean(T_DD_PeriodFlow, na.rm = T), 
            avg_qual = mean(T_DD_SleepQual, na.rm = T),
            avg_efcy = mean(efficiency_T, na.rm = T),
            avg_waso = mean(waso_T, na.rm = T),
            avg_time = mean(sleep_time_T, na.rm = T))
# The participants using painkillers had a higher average pain level than those who did not, but pain level for both of these cohorts is subjectively low (0.392 for pk = 0, 1.7 for pk = 1). Average flow was also higher for those taking painkillers at 2.4 compared to 0.683 for those not taking painkillers. Sleep quality and efficiency were higher in those taking painkillers, but they spent more time awake after sleep onset. The average sleep time is the same for both cohorts.

#How much is missing?
# apply(sleepfull, 2, function(x){sum(is.na(x))})
# 603 of the observations are missing values for T_DD_PeriodDay, which could be problematic if 
# we're ever interested in looking at when pain or flow is at it's highest?

## Plots

# Pain and Flow vs. Total Sleep time
ggplot(aes(x = T_DD_PeriodPain, y = sleep_time_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Pain vs. Total Sleep Time", x = "Period Pain", y = "Total Sleep Time", color = "Period")
ggplot(aes(x = T_DD_PeriodFlow, y = sleep_time_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Flow vs. Total Sleep Time", x = "Period Flow", y = "Total Sleep Time", color = "Period")

# Pain and Flow vs. Sleep Offset
ggplot(aes(x = T_DD_PeriodPain, y = end_time_dec_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Pain vs. Sleep Offset", x = "Period Pain", y = "Sleep Offset", color = "Period")
ggplot(aes(x = T_DD_PeriodFlow, y = end_time_dec_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Flow vs. Sleep Offset", x = "Period Pain", y = "Sleep Offset", color = "Period")

# Pain and Flow vs. Sleep Onset
ggplot(aes(x = T_DD_PeriodPain, y = start_time_TRM_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Pain vs. Sleep Onset", x = "Period Pain", y = "Sleep Onset", color = "Period")
ggplot(aes(x = T_DD_PeriodFlow, y = start_time_TRM_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Flow vs. Sleep Onset", x = "Period Flow", y = "Sleep Onset", color = "Period")

# Pain and Flow vs. Sleep Efficiency
ggplot(aes(x = T_DD_PeriodPain, y = efficiency_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Pain vs. Sleep Efficiency", x = "Period Pain", y = "Sleep Efficiency", color = "Period")
ggplot(aes(x = T_DD_PeriodFlow, y = efficiency_T, color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Flow vs. Sleep Efficiency", x = "Period Flow", y = "Sleep Efficiency", color = "Period")

# Pain and Flow vs. log-Wake After Sleep Onset
ggplot(aes(x = T_DD_PeriodPain, y = log(waso_T + 1), color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Pain vs. log-WASO", x = "Period Pain", y = "log-WASO", color = "Period")
ggplot(aes(x = T_DD_PeriodFlow, y = log(waso_T + 1), color = as.factor(T_DD_Period)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Flow vs. log-WASO", x = "Period Flow", y = "log-WASO", color = "Period")

# Pain and Flow vs. log-WASO across Time 0 and 1
ggplot(aes(x = T_DD_PeriodPain, y = log(waso_T + 1), color = as.factor(Time)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Pain vs. log-WASO", x = "Period Pain", y = "log-WASO", color = "Time")
ggplot(aes(x = T_DD_PeriodFlow, y = log(waso_T + 1), color = as.factor(Time)), data = sleepfull) + geom_point() + geom_smooth() +
  labs(title = "Period Flow vs. log-WASO", x = "Period Flow", y = "log-WASO", color = "Time")
```

# Models & Tests

## Sleep Duration (sleep_time_T)

```{r}
## PAIN
# All
mod_sleep_time_all <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
summary(mod_sleep_time_all)
confint(mod_sleep_time_all)
vif(mod_sleep_time_all)
# No evidence of multicollinearity in this model
plot(mod_sleep_time_all)
qqnorm(resid(mod_sleep_time_all))
qqnorm(ranef(mod_sleep_time_all)$C_ID[,1])
# partial f test
mod_red <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
anova(mod_red, mod_sleep_time_all)
# Chisq = 17.6, p = 0.000157, therefore meaning that adding an interaction term between age and time to our mixed effects model predicting total sleep time across both timepoints is statistically significant.

# Pulling the model data
mod_dat <- mod_sleep_time_all@frame
mod_ids <- mod_dat$C_ID
mod_obs <- sleepfull %>% 
  filter(C_ID %in% mod_ids) %>% 
  select(sleep_time_T, end_time_dec_T, start_time_TRM_T, efficiency_T, waso_T, BodyTotal, weekend, T_DD_Period, BMI, age, T_DD_PeriodPain, T_DD_PeriodFlow, C_ID, Time) %>% 
  drop_na()

table(mod_obs %>% filter(Time == 0) %>% select(T_DD_Period), useNA = "always")
table(mod_obs %>% filter(Time == 1) %>% select(T_DD_Period), useNA = "always")

mod_obs %>% 
  group_by(Time) %>% 
  summarize(avg_dur = mean(sleep_time_T, na.rm = T),
            sd_dur = sd(sleep_time_T, na.rm = T))



# t1
mod_sleep_time_0 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_sleep_time_0)
# At timepoint 1, when a participant was on their period, they got 3.088 more minutes of sleep compared to those not on their period. Contrary to the model across both time points, for a one point increase in period pain, participants got 1.517 more minutes of sleep.
confint(mod_sleep_time_0)
vif(mod_sleep_time_0)
# No evidence of multicollinearity
plot(mod_sleep_time_0)
qqnorm(resid(mod_sleep_time_0))
qqnorm(ranef(mod_sleep_time_0)$C_ID[,1])
# Assumptions look good

#t2
hist(sleepfull$sleep_time_T)
mod_sleep_time_1 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_sleep_time_1)
confint(mod_sleep_time_1)
vif(mod_sleep_time_1)
# No evidence of multicollinearity
plot(mod_sleep_time_1)
qqnorm(resid(mod_sleep_time_1))
qqnorm(ranef(mod_sleep_time_1)$C_ID[,1])

## FLOW
# All
mod_sleep_time_all <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_sleep_time_all)
confint(mod_sleep_time_all)
vif(mod_sleep_time_all)
# No evidence of multicollinearity
plot(mod_sleep_time_all)
qqnorm(resid(mod_sleep_time_all))
qqnorm(ranef(mod_sleep_time_all)$C_ID[,1])
# partial f test
mod_red <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_sleep_time_all)

# t1
mod_sleep_time_0 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_sleep_time_0)
confint(mod_sleep_time_0)
vif(mod_sleep_time_0)
# No evidence of multicollinearity
plot(mod_sleep_time_0)
qqnorm(resid(mod_sleep_time_0))
qqnorm(ranef(mod_sleep_time_0)$C_ID[,1])

# t2
mod_sleep_time_1 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_sleep_time_1)
confint(mod_sleep_time_1)
vif(mod_sleep_time_1)
# No evidence of multicollinearity
plot(mod_sleep_time_1)
qqnorm(resid(mod_sleep_time_1))
qqnorm(ranef(mod_sleep_time_1)$C_ID[,1])

## PAIN & FLOW 
# All
mod_sleep_time_all <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_sleep_time_all)
confint(mod_sleep_time_all)
vif(mod_sleep_time_all)
# No evidence of multicollinearity
plot(mod_sleep_time_all)
qqnorm(resid(mod_sleep_time_all))
qqnorm(ranef(mod_sleep_time_all)$C_ID[,1])
# partial f test
mod_red <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_sleep_time_all)


#t1
mod_sleep_time_0 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_sleep_time_0)
confint(mod_sleep_time_0)
vif(mod_sleep_time_0)
# No evidence of multicollinearity
plot(mod_sleep_time_0)
qqnorm(resid(mod_sleep_time_0))
qqnorm(ranef(mod_sleep_time_0)$C_ID[,1])

# t2
mod_sleep_time_1 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_sleep_time_1)
confint(mod_sleep_time_1)
vif(mod_sleep_time_1)
# No evidence of multicollinearity
plot(mod_sleep_time_1)
qqnorm(resid(mod_sleep_time_1))
qqnorm(ranef(mod_sleep_time_1)$C_ID[,1])

## PAIN:FLOW
# All
mod_sleep_time_all <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_sleep_time_all)
confint(mod_sleep_time_all)
vif(mod_sleep_time_all)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, Period, and PeriodFlow
plot(mod_sleep_time_all)
qqnorm(resid(mod_sleep_time_all))
qqnorm(ranef(mod_sleep_time_all)$C_ID[,1])
# partial f test
mod_red <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_sleep_time_all)

#t1
mod_sleep_time_0 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_sleep_time_0)
confint(mod_sleep_time_0)
vif(mod_sleep_time_0)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, and Period
plot(mod_sleep_time_0)
qqnorm(resid(mod_sleep_time_0))
qqnorm(ranef(mod_sleep_time_0)$C_ID[,1])

# t2
mod_sleep_time_1 <- lmer(sleep_time_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_sleep_time_1)
confint(mod_sleep_time_1)
vif(mod_sleep_time_1)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow and PeriodPain, moderate evidence of multicollinearity for PeriodFlow and Period
plot(mod_sleep_time_1)
qqnorm(resid(mod_sleep_time_1))
qqnorm(ranef(mod_sleep_time_1)$C_ID[,1])
```

The mixed effects models predicting sleep time do not display any troubling evidence of multicollinearity, except for in the models that have interaction terms between PeriodPain and PeriodFlow. High VIF in models with interaction terms is not of concern, though. For all of the above models, there were no marked violations of the assumptions of homogeneity and normality of the residuals, and the random effects appear to be normally distributed as well. There is a right-facing horn shape in the residual plots for timepoint 2, and an outlier in the timepoint 1 data, but nothing that sticks out to the point of concern.

## Offset/Waketime (end_time_dec_T)

```{r}
#C_ID 494 is waking up at like 10pm?
ggplot(aes(x = end_time_dec_T), data = sleepfull) + geom_histogram()
sleepfull %>% filter(end_time_dec_T > 20)

sleepfull$end_time_dec_T[!is.na(sleepfull$end_time_dec_T) & sleepfull$end_time_dec_T > 20] <- sleepfull$end_time_dec_T[!is.na(sleepfull$end_time_dec_T) & sleepfull$end_time_dec_T > 20] - 24

## PAIN
hist(sleepfull$end_time_dec_T)
# All
mod_offset_all <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
summary(mod_offset_all)
confint(mod_offset_all)
vif(mod_offset_all)
# No evidence of multicollinearity
plot(mod_offset_all)
qqnorm(resid(mod_offset_all))
qqnorm(ranef(mod_offset_all)$C_ID[,1])
# Violations of homogeneity and normality for the residuals. On the residual-fitted plot, there appears to be outliers on both axes.
# partial f test
mod_red <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
anova(mod_red, mod_offset_all)

# t1
mod_offset_0 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_offset_0)
confint(mod_offset_0)
vif(mod_offset_0)
# No evidence of multicollinearity
plot(mod_offset_0)
qqnorm(resid(mod_offset_0))
qqnorm(ranef(mod_offset_0)$C_ID[,1])
# Same violations as before

# t2
mod_offset_1 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_offset_1)
confint(mod_offset_1)
vif(mod_offset_1)
# No evidence of multicollinearity
plot(mod_offset_1)
qqnorm(resid(mod_offset_1))
qqnorm(ranef(mod_offset_1)$C_ID[,1])
# These plots are all normal

## FLOW
# All
mod_offset_all <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_offset_all)
confint(mod_offset_all)
vif(mod_offset_all)
# No evidence of multicollinearity
plot(mod_offset_all)
qqnorm(resid(mod_offset_all))
qqnorm(ranef(mod_offset_all)$C_ID[,1])
# Same issues as the pain all and 0 plots 
# partial f test
mod_red <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_offset_all)

# t1
mod_offset_0 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_offset_0)
confint(mod_offset_0)
vif(mod_offset_0)
# No evidence of multicollinearity
plot(mod_offset_0)
qqnorm(resid(mod_offset_0))
qqnorm(ranef(mod_offset_0)$C_ID[,1])
# ditto

# t2
mod_offset_1 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_offset_1)
confint(mod_offset_1)
vif(mod_offset_1)
# No evidence of multicollinearity
plot(mod_offset_1)
qqnorm(resid(mod_offset_1))
qqnorm(ranef(mod_offset_1)$C_ID[,1])
# These all look fine

## PAIN & FLOW 
# All
mod_offset_all <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_offset_all)
confint(mod_offset_all)
vif(mod_offset_all)
# No evidence of multicollinearity
plot(mod_offset_all)
qqnorm(resid(mod_offset_all))
qqnorm(ranef(mod_offset_all)$C_ID[,1])
# partial f test
mod_red <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_offset_all)

#t1
mod_offset_0 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_offset_0)
confint(mod_offset_0)
vif(mod_offset_0)
# Moderate evidence of multicollinearity for PeriodFlow
plot(mod_offset_0)
qqnorm(resid(mod_offset_0))
qqnorm(ranef(mod_offset_0)$C_ID[,1])
# Same problems

# t2
mod_offset_1 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_offset_1)
confint(mod_offset_1)
vif(mod_offset_1)
# No evidence of multicollinearity
plot(mod_offset_1)
qqnorm(resid(mod_offset_1))
qqnorm(ranef(mod_offset_1)$C_ID[,1])
# Time 2 is once again fine

## PAIN:FLOW
# All
mod_offset_all <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_offset_all)
confint(mod_offset_all)
vif(mod_offset_all)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, and Period
plot(mod_offset_all)
qqnorm(resid(mod_offset_all))
qqnorm(ranef(mod_offset_all)$C_ID[,1])
# Continuation of strange plots across both time points. There's going to need to be more of a fix. 
# partial f test
mod_red <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_offset_all)

#t1
mod_offset_0 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_offset_0)
confint(mod_offset_0)
vif(mod_offset_0)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, Period
plot(mod_offset_0)
qqnorm(resid(mod_offset_0))
qqnorm(ranef(mod_offset_0)$C_ID[,1])
# Again, residual and qqplots are messed up

# t2
mod_offset_1 <- lmer(end_time_dec_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_offset_1)
confint(mod_offset_1)
vif(mod_offset_1)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow and PeriodPain, and moderate evidence of multicollinearity for PeriodFlow and Period
plot(mod_offset_1)
qqnorm(resid(mod_offset_1))
qqnorm(ranef(mod_offset_1)$C_ID[,1])
# Time 2 is good.
```

The mixed models predicting sleep offset time showed no significant evidence of multicollinearity, but the assumptions of homogeneity and normality for the residuals and normality for the random effects were violated for the "All" and "t1" models. These violations are likely due to the consistently abnormal offset times observed in participants 494 and 522, both of whom were "t1" participants. All of 494's offset times were observed between 9:53pm and 11:28pm, which is reflected in the raw data. On her fourth day, she made a note saying that the time on her actigraphy watch was incorrect. All of participant 522's offset times were observed between 11:13pm and 3:09am, but she never made a note about the time on her watch. None of the "t2" models violated the assumptions.

## Onset/Falling Asleep (start_time_TRM_T)

```{r}
## PAIN
# All
mod_onset_all <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
summary(mod_onset_all)
confint(mod_onset_all)
vif(mod_onset_all)
# No evidence of multicollinearity
plot(mod_onset_all)
qqnorm(resid(mod_onset_all))
qqnorm(ranef(mod_onset_all)$C_ID[,1])
# Onset has the same problems as offset. Even with 494 and 522 removed, there's still a violation of homogeneity for the residuals.
# partial f test
mod_red <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
anova(mod_red, mod_onset_all)

# t1
mod_onset_0 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_onset_0)
confint(mod_onset_0)
vif(mod_onset_0)
# No evidence of multicollinearity
plot(mod_onset_0)
qqnorm(resid(mod_onset_0))
qqnorm(ranef(mod_onset_0)$C_ID[,1])

# t2
mod_onset_1 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_onset_1)
confint(mod_onset_1)
vif(mod_onset_1)
# No evidence of multicollinearity
plot(mod_onset_1)
qqnorm(resid(mod_onset_1))
qqnorm(ranef(mod_onset_1)$C_ID[,1])
# Time 2 is fine for the most part, but there are some outliers far below the x-axis

## FLOW
# All
mod_onset_all <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_onset_all)
confint(mod_onset_all)
vif(mod_onset_all)
# No evidence of multicollinearity
plot(mod_onset_all)
qqnorm(resid(mod_onset_all))
qqnorm(ranef(mod_onset_all)$C_ID[,1])
# partial f test
mod_red <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_onset_all)

# t1
mod_onset_0 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_onset_0)
confint(mod_onset_0)
vif(mod_onset_0)
# No evidence of multicollinearity
plot(mod_onset_0)
qqnorm(resid(mod_onset_0))
qqnorm(ranef(mod_onset_0)$C_ID[,1])

# t2
mod_onset_1 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_onset_1)
confint(mod_onset_1)
vif(mod_onset_1)
# No evidence of multicollinearity
plot(mod_onset_1)
qqnorm(resid(mod_onset_1))
qqnorm(ranef(mod_onset_1)$C_ID[,1])
# Negative outliers again

## PAIN & FLOW
# All
mod_onset_all <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_onset_all)
confint(mod_onset_all)
vif(mod_onset_all)
# No evidence of multicollinearity
plot(mod_onset_all)
qqnorm(resid(mod_onset_all))
qqnorm(ranef(mod_onset_all)$C_ID[,1])
# partial f test
mod_red <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_onset_all)

# t1
mod_onset_0 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_onset_0)
confint(mod_onset_0)
vif(mod_onset_0)
# Moderate evidence of multicollinearity for PeriodFlow
plot(mod_onset_0)
qqnorm(resid(mod_onset_0))
qqnorm(ranef(mod_onset_0)$C_ID[,1])

# t2
mod_onset_1 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_onset_1)
confint(mod_onset_1)
vif(mod_onset_1)
# No evidence of multicollinearity
plot(mod_onset_1)
qqnorm(resid(mod_onset_1))
qqnorm(ranef(mod_onset_1)$C_ID[,1])
# Negative outliers again

## PAIN:FLOW
# All
mod_onset_all <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_onset_all)
confint(mod_onset_all)
vif(mod_onset_all)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, Period
plot(mod_onset_all)
qqnorm(resid(mod_onset_all))
qqnorm(ranef(mod_onset_all)$C_ID[,1])
# partial f test
mod_red <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_onset_all)

# t1
mod_onset_0 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_onset_0)
confint(mod_onset_0)
vif(mod_onset_0)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, Period
plot(mod_onset_0)
qqnorm(resid(mod_onset_0))
qqnorm(ranef(mod_onset_0)$C_ID[,1])

# t2
mod_onset_1 <- lmer(start_time_TRM_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_onset_1)
confint(mod_onset_1)
vif(mod_onset_1)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow and PeriodPain, and moderate evidence of multicollinearity for PeriodFlow and Period
plot(mod_onset_1)
qqnorm(resid(mod_onset_1))
qqnorm(ranef(mod_onset_1)$C_ID[,1])
# Same issues
```

Similarly to the mixed effects models for sleep offset time, there is no evidence of multicollinearity across the board, but the assumptions are violated for each of the "All" and "t1" models. The assumptions were not violated for the "t2" models. I checked each of the models assumptions without the participants that were identified as outliers in the offset plots, but homogeneity was still violated for the "All" and "t1" models. There are also two outliers in "t2" that should be investigated.

## Efficiency (efficiency_T)

```{r}
## PAIN
# All
mod_eff_all <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
summary(mod_eff_all)
# Only the model intercept is statistically significant at alpha = 0.05
confint(mod_eff_all)
vif(mod_eff_all)
# No evidence of multicollinearity
plot(mod_eff_all)
qqnorm(resid(mod_eff_all))
qqnorm(ranef(mod_eff_all)$C_ID[,1])
# All of these plots look decent, but there is one obvious outlier
# partial f test
mod_red <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
anova(mod_red, mod_eff_all)

# t1
mod_eff_0 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_eff_0)
confint(mod_eff_0)
# Only T_DD_Period is significant at alpha = 0.05. Pain is significant at 0.1, but 0 is in the 95% CI.
vif(mod_eff_0)
# No evidence of multicollinearity
plot(mod_eff_0)
qqnorm(resid(mod_eff_0))
qqnorm(ranef(mod_eff_0)$C_ID[,1])
# Again, assumptions aren't violated but there is a clear outlier. The outlier from the All plots is most likely from t1.

# t2
mod_eff_1 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_eff_1)
confint(mod_eff_1)
# Only the intercept is significant
vif(mod_eff_1)
# No evidence of multicollinearity
plot(mod_eff_1)
qqnorm(resid(mod_eff_1))
qqnorm(ranef(mod_eff_1)$C_ID[,1])
# This looks good too. Maybe some outlier activity?

## FLOW
# All
mod_eff_all <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_eff_all)
confint(mod_eff_all)
# Only the intercept is significant
vif(mod_eff_all)
# No evidence of multicollinearity
plot(mod_eff_all)
qqnorm(resid(mod_eff_all))
qqnorm(ranef(mod_eff_all)$C_ID[,1])
# Again, the outlier is the only exception
# partial f test
mod_red <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_eff_all)

# t1
mod_eff_0 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_eff_0)
confint(mod_eff_0)
# Only the intercept is significant at 0.05. T_DD_Period is sig. at 0.1
vif(mod_eff_0)
# No evidence of multicollinearity
plot(mod_eff_0)
qqnorm(resid(mod_eff_0))
qqnorm(ranef(mod_eff_0)$C_ID[,1])

# t2
mod_eff_1 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_eff_1)
confint(mod_eff_1)
# Only intercept is significant
vif(mod_eff_1)
# No evidence of multicollinearity
plot(mod_eff_1)
qqnorm(resid(mod_eff_1))
qqnorm(ranef(mod_eff_1)$C_ID[,1])

## PAIN & FLOW
# All
mod_eff_all <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_eff_all)
confint(mod_eff_all)
# Intercept is significant at 0.001, Period is significant at 0.1 but 0 is in the confidence interval
vif(mod_eff_all)
# No evidence of multicollinearity
plot(mod_eff_all)
qqnorm(resid(mod_eff_all))
qqnorm(ranef(mod_eff_all)$C_ID[,1])
# partial f test
mod_red <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_eff_all)

# t1
mod_eff_0 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_eff_0)
confint(mod_eff_0)
# T_DD_Period significant at 0.1. 0 is not in the 95% CI.
vif(mod_eff_0)
# Moderate evidence of multicollinearity for PeriodFlow
plot(mod_eff_0)
qqnorm(resid(mod_eff_0))
qqnorm(ranef(mod_eff_0)$C_ID[,1])

# t2
mod_eff_1 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_eff_1)
confint(mod_eff_1)
# Intercept is sig.
vif(mod_eff_1)
# No evidence of multicollinearity
plot(mod_eff_1)
qqnorm(resid(mod_eff_1))
qqnorm(ranef(mod_eff_1)$C_ID[,1])

## PAIN:FLOW
# All
mod_eff_all <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_eff_all)
confint(mod_eff_all)
# Intercept is sig.
vif(mod_eff_all)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, and Period
plot(mod_eff_all)
qqnorm(resid(mod_eff_all))
qqnorm(ranef(mod_eff_all)$C_ID[,1])
# partial f test
mod_red <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_eff_all)

# t1
mod_eff_0 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_eff_0)
confint(mod_eff_0)
# Intercept sig. at 0.001, Period sig at 0.05
vif(mod_eff_0)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, and Period
plot(mod_eff_0)
qqnorm(resid(mod_eff_0))
qqnorm(ranef(mod_eff_0)$C_ID[,1])

# t2
mod_eff_1 <- lmer(efficiency_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_eff_1)
confint(mod_eff_1)
vif(mod_eff_1)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow and PeriodPain, moderate evidence of multicollinearity for PeriodFlow and Period
plot(mod_eff_1)
qqnorm(resid(mod_eff_1))
qqnorm(ranef(mod_eff_1)$C_ID[,1])
```

For the mixed models predicting sleep efficiency, there is no significant evidence of multicollinearity. As for the model assumptions, there are no glaring violations, but there is one obvious outlier in the bottom left corner of the residual plots for the "All" and "t1" models.

## Wake After Sleep Onset (waso_T)

```{r}
hist(sleepfull$waso_T) # might need log due to right-skew

## PAIN
# All
mod_waso_all <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
summary(mod_waso_all)
confint(mod_waso_all)
# Only BodyTotal and BMI are significant
vif(mod_waso_all)
# No evidence of multicollinearity
plot(mod_waso_all)
qqnorm(resid(mod_waso_all))
qqnorm(ranef(mod_waso_all)$C_ID[,1])
# This model has definitely got some funk to it. While the assumption of homogeneity isn't violated, the QQ plot of the residuals shows a violation. 
# partial f test
mod_red <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
anova(mod_red, mod_waso_all)

# t1
mod_waso_0 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_waso_0)
confint(mod_waso_0)
# Only the intercept is significant
vif(mod_waso_0)
# No evidence of multicollinearity
plot(mod_waso_0)
qqnorm(resid(mod_waso_0))
qqnorm(ranef(mod_waso_0)$C_ID[,1])
# Outliers and vil

# t2
mod_waso_1 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_waso_1)
confint(mod_waso_1)
# Period Pain is significant at 0.001, but Period is not significant at all? Also the intercept here is -87.807, which means that holding all variables constant, WASO is -87.807? How can you spend -87 minutes awake after falling asleep?
vif(mod_waso_1)
# No evidence of multicollinearity
plot(mod_waso_1)
qqnorm(resid(mod_waso_1))
qqnorm(ranef(mod_waso_1)$C_ID[,1])

## FLOW
# All
mod_waso_all <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_waso_all)
confint(mod_waso_all)
vif(mod_waso_all)
# No evidence of multicollinearity
plot(mod_waso_all)
qqnorm(resid(mod_waso_all))
qqnorm(ranef(mod_waso_all)$C_ID[,1])
# partial f test
mod_red <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_waso_all)

# t1
mod_waso_0 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_waso_0)
confint(mod_waso_0)
# Only intercept sig.
vif(mod_waso_0)
# No evidence of multicollinearity
plot(mod_waso_0)
qqnorm(resid(mod_waso_0))
qqnorm(ranef(mod_waso_0)$C_ID[,1])

# t2
mod_waso_1 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_waso_1)
confint(mod_waso_1)
vif(mod_waso_1)
# No evidence of multicollinearity
plot(mod_waso_1)
qqnorm(resid(mod_waso_1))
qqnorm(ranef(mod_waso_1)$C_ID[,1])

## PAIN & FLOW
# All
mod_waso_all <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_waso_all)
confint(mod_waso_all)
vif(mod_waso_all)
# No evidence of multicollinearity
plot(mod_waso_all)
qqnorm(resid(mod_waso_all))
qqnorm(ranef(mod_waso_all)$C_ID[,1])
# partial f test
mod_red <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_waso_all)

# t1
mod_waso_0 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_waso_0)
confint(mod_waso_0)
vif(mod_waso_0)
# Moderate evidence of multicollinearity for PeriodFlow
plot(mod_waso_0)
qqnorm(resid(mod_waso_0))
qqnorm(ranef(mod_waso_0)$C_ID[,1])

# t2
mod_waso_1 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_waso_1)
confint(mod_waso_1)
vif(mod_waso_1)
# No evidence of multicollinearity
plot(mod_waso_1)
qqnorm(resid(mod_waso_1))
qqnorm(ranef(mod_waso_1)$C_ID[,1])

## PAIN:FLOW
# All
mod_waso_all <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_waso_all)
confint(mod_waso_all)
vif(mod_waso_all)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, and Period
plot(mod_waso_all)
qqnorm(resid(mod_waso_all))
qqnorm(ranef(mod_waso_all)$C_ID[,1])
# partial f test
mod_red <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_waso_all)

# t1
mod_waso_0 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_waso_0)
confint(mod_waso_0)
vif(mod_waso_0)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, PeriodFlow, and Period
plot(mod_waso_0)
qqnorm(resid(mod_waso_0))
qqnorm(ranef(mod_waso_0)$C_ID[,1])

# t2
mod_waso_1 <- lmer(waso_T ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_waso_1)
confint(mod_waso_1)
# Pain and Flow are highly significant in this model, as is Period and the interaction term between PeriodPain and PeriodFlow.
vif(mod_waso_1)
# Significant evidence of multicollinearity for PeriodPain:PeriodFlow, PeriodPain, moderate evidence of multicollinearity for PeriodFlow and Period
plot(mod_waso_1)
qqnorm(resid(mod_waso_1))
qqnorm(ranef(mod_waso_1)$C_ID[,1])
```

For the mixed models predicting WASO, there was no significant evidence of multicollinearity. However, the assumption of normally distributed residuals is violated for the "All" and "t1" models, while the assumptions of homogeneity are not overtly violated but certainly questionable for every WASO model, particularly the "t2" models. This implies that we might want to consider a different transformation for WASO, if any at all.

## Sleep Quality (T_DD_SleepQual)

```{r}
hist(sleepfull$T_DD_SleepQual)

## PAIN
# All
mod_qual_all <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
summary(mod_qual_all)
confint(mod_qual_all)
vif(mod_qual_all)
plot(mod_qual_all)
qqnorm(resid(mod_qual_all))
qqnorm(ranef(mod_qual_all)$C_ID[,1])
# partial f test
mod_red <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull)
anova(mod_red, mod_qual_all)

# t1
mod_qual_0 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_qual_0)
confint(mod_qual_0)
vif(mod_qual_0)
plot(mod_qual_0)
qqnorm(resid(mod_qual_0))
qqnorm(ranef(mod_qual_0)$C_ID[,1])

# t2
mod_qual_1 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_qual_1)
confint(mod_qual_1)
vif(mod_qual_1)
plot(mod_qual_1)
qqnorm(resid(mod_qual_1))
qqnorm(ranef(mod_qual_1)$C_ID[,1])

## FLOW
# All
mod_qual_all <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_qual_all)
confint(mod_qual_all)
vif(mod_qual_all)
plot(mod_qual_all)
qqnorm(resid(mod_qual_all))
qqnorm(ranef(mod_qual_all)$C_ID[,1])
# partial f test
mod_red <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_qual_all)

# t1
mod_qual_0 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_qual_0)
confint(mod_qual_0)
vif(mod_qual_0)
plot(mod_qual_0)
qqnorm(resid(mod_qual_0))
qqnorm(ranef(mod_qual_0)$C_ID[,1])

# t2
mod_qual_1 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_qual_1)
confint(mod_qual_1)
vif(mod_qual_1)
plot(mod_qual_1)
qqnorm(resid(mod_qual_1))
qqnorm(ranef(mod_qual_1)$C_ID[,1])

## PAIN & FLOW
# All
mod_qual_all <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_qual_all)
confint(mod_qual_all)
vif(mod_qual_all)
plot(mod_qual_all)
qqnorm(resid(mod_qual_all))
qqnorm(ranef(mod_qual_all)$C_ID[,1])
# partial f test
mod_red <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_qual_all)

# t1
mod_qual_0 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_qual_0)
confint(mod_qual_0)
vif(mod_qual_0)
plot(mod_qual_0)
qqnorm(resid(mod_qual_0))
qqnorm(ranef(mod_qual_0)$C_ID[,1])

# t2
mod_qual_1 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain + T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_qual_1)
confint(mod_qual_1)
vif(mod_qual_1)
plot(mod_qual_1)
qqnorm(resid(mod_qual_1))
qqnorm(ranef(mod_qual_1)$C_ID[,1])

## PAIN:FLOW
# All
mod_qual_all <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) * Time + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
summary(mod_qual_all)
confint(mod_qual_all)
vif(mod_qual_all)
plot(mod_qual_all)
qqnorm(resid(mod_qual_all))
qqnorm(ranef(mod_qual_all)$C_ID[,1])
# partial f test
mod_red <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull)
anova(mod_red, mod_qual_all)

# t1
mod_qual_0 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 0))
summary(mod_qual_0)
confint(mod_qual_0)
vif(mod_qual_0)
plot(mod_qual_0)
qqnorm(resid(mod_qual_0))
qqnorm(ranef(mod_qual_0)$C_ID[,1])

# t2
mod_qual_1 <- lmer(T_DD_SleepQual ~ 1 + BodyTotal + weekend + T_DD_Period + BMI + I(age-13) + T_DD_PeriodPain*T_DD_PeriodFlow + (1|C_ID), data = sleepfull %>% filter(Time == 1))
summary(mod_qual_1)
confint(mod_qual_1)
vif(mod_qual_1)
plot(mod_qual_1)
qqnorm(resid(mod_qual_1))
qqnorm(ranef(mod_qual_1)$C_ID[,1])
```

# Correlation Matrix

```{r}
cor(sleepfull %>% select(BodyTotal, weekend, T_DD_Period, BMI, age, T_DD_PeriodPain, T_DD_PeriodFlow), use = "complete.obs")
```

Participant 258 is validated. 494 and 522 are being dropped.

# Looking for Missing Data

```{r}
missing <- data.frame(colSums(is.na(sleepfull)))
library(VIM)
aggr(sleepfull %>% select(start_time_TRM_T, end_time_dec_T, efficiency_T, waso_T,
                          sleep_time_T, T_DD_PeriodFlow, T_DD_PeriodPain, T_DD_SleepQual,
                          BMI, BodyTotal, weekend, age))

matrixplot(sleepfull %>% select(start_time_TRM_T, end_time_dec_T, efficiency_T, waso_T,
                          sleep_time_T, T_DD_Period, T_DD_PeriodFlow, T_DD_PeriodPain,
                          T_DD_SleepQual, BMI, BodyTotal, weekend, age), interactive = TRUE)
```

start_time_TRM_T - 119

end_time_dec_T - 119

efficiency_T - 119

waso_T - 119

sleep_time_T - 119

T_DD_PeriodFlow - 43

T_DD_Period - 41

T_DD_PeriodPain - 41

T_DD_SleepQual - 34

BMI - 21

BodyTotal - 7

weekend - 0

age -0
